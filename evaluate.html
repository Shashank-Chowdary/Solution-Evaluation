<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LTTS's Path to Autonomous AI: A Project-Level Evaluation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            line-height: 1.4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .header p {
            color: #86868b;
            font-size: 14px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }

        .left-panel {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .right-panel {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
        }

        .section {
            margin-bottom: 25px;
        }

        .section h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1d1d1f;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #424245;
        }

        .required {
            color: #ff3b30;
        }

        input[type="text"], select {
            width: 100%;
            padding: 12px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #007aff;
            box-shadow: 0 0 0 3px rgba(0,122,255,0.1);
        }

        textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            font-family: inherit;
        }

        textarea:focus {
            outline: none;
            border-color: #007aff;
            box-shadow: 0 0 0 3px rgba(0,122,255,0.1);
        }

        .category-section {
            margin-bottom: 30px;
            border: 2px solid #e5e5ea;
            border-radius: 12px;
            padding: 20px;
            background: #fafafa;
        }

        .category-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1d1d1f;
        }

        .category-weight {
            font-size: 12px;
            color: #86868b;
            margin-bottom: 20px;
            font-style: italic;
        }

        .business-value { border-color: #34c759; }
        .technical-fit { border-color: #007aff; }
        .safety-governance { border-color: #ff9500; }

        .risk-factors {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .factor-group {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e5e5ea;
        }

        .factor-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1d1d1f;
        }

        .factor-subtitle {
            font-size: 12px;
            color: #86868b;
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .risk-buttons {
            display: flex;
            gap: 8px;
        }

        .risk-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d2d2d7;
            border-radius: 6px;
            background: white;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .risk-btn:hover {
            background: #f5f5f7;
            border-color: #007aff;
            transform: translateY(-1px);
        }

        .risk-btn.active {
            color: white !important;
            border-color: transparent !important;
            transform: translateY(-1px);
        }

        .risk-btn.score-1.active {
            background: #34c759 !important;
        }

        .risk-btn.score-3.active {
            background: #ff9500 !important;
        }

        .risk-btn.score-5.active {
            background: #ff3b30 !important;
        }

        .framework-section h3 {
            color: #1d1d1f;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .framework-content {
            font-size: 14px;
            color: #424245;
            line-height: 1.5;
            margin-bottom: 25px;
        }

        .alternatives h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .alternatives ul {
            list-style: none;
        }

        .alternatives li {
            font-size: 13px;
            color: #424245;
            margin-bottom: 12px;
            padding-left: 15px;
            position: relative;
        }

        .alternatives li:before {
            content: "•";
            color: #007aff;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .mitigations h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .mitigations ul {
            list-style: none;
        }

        .mitigations li {
            font-size: 13px;
            color: #424245;
            margin-bottom: 12px;
            padding-left: 15px;
            position: relative;
        }

        .mitigations li:before {
            content: "•";
            color: #ff9500;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .decision-output {
            background: #f9f9fb;
            border: 2px solid #e5e5ea;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
        }

        .decision-placeholder {
            color: #86868b;
            font-size: 14px;
            font-style: italic;
        }

        .decision-result {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.5;
        }

        .decision-proceed {
            background: #f0fff0;
            border-color: #34c759;
            color: #1d6f32;
        }

        .decision-pilot {
            background: #fff8f0;
            border-color: #ff9500;
            color: #b8630a;
        }

        .decision-postpone {
            background: #fff0f0;
            border-color: #ff3b30;
            color: #d12b20;
        }

        .decision-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .decision-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .decision-subtitle {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 12px;
        }

        .score-display {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .score-display h4 {
            color: #007aff;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .score-breakdown {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }

        .score-item {
            text-align: center;
            font-size: 12px;
        }

        .score-item .score-label {
            color: #424245;
            margin-bottom: 2px;
        }

        .score-item .score-value {
            font-weight: 600;
            color: #1d1d1f;
        }

        .total-score {
            text-align: center;
            padding-top: 10px;
            border-top: 1px solid #d2d2d7;
            margin-top: 10px;
        }

        .total-score .score-label {
            color: #424245;
            font-size: 12px;
            margin-bottom: 2px;
        }

        .total-score .score-value {
            font-size: 18px;
            font-weight: 700;
            color: #007aff;
        }

        .awaiting-input {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .awaiting-input h4 {
            color: #007aff;
            font-size: 14px;
            font-weight: 600;
        }

        .awaiting-input p {
            color: #424245;
            font-size: 12px;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: #007aff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056cc;
        }

        .btn-secondary {
            background: #f5f5f7;
            color: #424245;
            border: 1px solid #d2d2d7;
        }

        .btn-secondary:hover {
            background: #e5e5ea;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            color: #ff3b30;
            font-size: 12px;
            margin-top: 5px;
        }

        .preset-section {
            background: #f0f8ff;
            border: 2px solid #b3d9ff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .preset-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #007aff;
        }

        .preset-loading {
            background: #fff8f0;
            border: 1px solid #ff9500;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-top: 15px;
        }

        .preset-loading h4 {
            color: #ff9500;
            font-size: 14px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .risk-factors {
                grid-template-columns: 1fr;
            }
            
            .score-breakdown {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>LTTS's Path to Autonomous AI: A Project-Level Evaluation</h1>
            <p>AI-powered assessment tool that provides intelligent recommendations based on your specific use case context and risk factors.</p>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="section">
                    <h3>Use Case Information</h3>
                    <div class="form-group">
                        <label for="usecaseName">Use Case Name</label>
                        <input type="text" id="usecaseName" placeholder="Enter your use case name">
                    </div>
                    <div class="form-group">
                        <label for="description">Use Case Description <span class="required">*</span></label>
                        <textarea id="description" placeholder="Detailed description of the use case, stakeholders involved, and expected outcomes" required></textarea>
                        <div id="descriptionError" class="error-message" style="display: none;">Description is required</div>
                    </div>
                </div>

                <div class="section">
                    <div class="form-group">
                        <label>Anticipated Autonomy Level</label>
                        <select id="autonomyLevel">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium — Human-on-the-loop</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <div class="form-group">
                        <label>Does this affect our customers or regulatory compliance?</label>
                        <select id="criticality">
                            <option value="yes" selected>Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                </div>

                <!-- Preset/Manual Risk Rating Section -->
                <div class="preset-section">
                    <div class="preset-title">Risk Assessment Method</div>
                    <div class="form-group">
                        <label>Choose Assessment Method</label>
                        <select id="assessmentMethod" onchange="handleAssessmentMethodChange()">
                            <option value="manual" selected>Manually select risk factors</option>
                            <option value="preset">Load role-specific preset</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="rolePresetGroup" style="display: none;">
                        <label>Select Role-Specific Preset</label>
                        <select id="rolePreset" onchange="handleRolePresetChange()">
                            <option value="">Select a role...</option>
                            <option value="finance">Finance (Regulatory/compliance-heavy)</option>
                            <option value="operations">Operations (Real-time control/process automation)</option>
                            <option value="security">Security (Access control/sensitive data)</option>
                            <option value="customer-service">Customer Service / Support (High human touch)</option>
                        </select>
                    </div>

                    <div id="presetLoading" class="preset-loading" style="display: none;">
                        <h4><span class="loading"></span>AI is analyzing your use case and applying role-specific risk ratings...</h4>
                    </div>
                </div>

                <!-- Business Value Category -->
                <div class="category-section business-value">
                    <div class="category-title">Business Value</div>
                    <div class="category-weight">Weight: 40% of total score</div>
                    <div class="risk-factors">
                        <div class="factor-group" data-factor="cost" data-category="business">
                            <div class="factor-title">Cost</div>
                            <div class="factor-subtitle">Operational costs (LLM API calls), system resource costs (IT infrastructure), and human resource costs (employee salaries and labor)</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'cost', 1)">Low (5)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'cost', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'cost', 5)">High (1)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="time-efficiency" data-category="business">
                            <div class="factor-title">Time Efficiency</div>
                            <div class="factor-subtitle">Cycle time reduction, throughput increase, and latency reduction for customer-facing tasks</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'time-efficiency', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'time-efficiency', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'time-efficiency', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="accuracy-quality" data-category="business">
                            <div class="factor-title">Accuracy & Quality</div>
                            <div class="factor-subtitle">Error rate reduction, compliance & audit success, and consistency in standardized task execution</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'accuracy-quality', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'accuracy-quality', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'accuracy-quality', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="productivity-scalability" data-category="business">
                            <div class="factor-title">Productivity & Scalability</div>
                            <div class="factor-subtitle">Employee productivity improvements, scalability for larger volumes, and automation coverage percentage</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'productivity-scalability', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'productivity-scalability', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'productivity-scalability', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="strategic-opportunity" data-category="business">
                            <div class="factor-title">Strategic/Opportunity Impact</div>
                            <div class="factor-subtitle">Innovation enablement for new business models, competitive advantage, and risk mitigation (financial, operational, compliance)</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'strategic-opportunity', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'strategic-opportunity', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'strategic-opportunity', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="transparency" data-category="business">
                            <div class="factor-title">Transparency</div>
                            <div class="factor-subtitle">Agentic AI's decisions may lack clear, traceable reasoning, posing compliance and trust risks in regulated or customer-facing contexts</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'transparency', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'transparency', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'transparency', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="human-impact" data-category="business">
                            <div class="factor-title">Human Impact</div>
                            <div class="factor-subtitle">AI cannot replicate empathy, and removing humans risks harming customer trust and brand reputation</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'human-impact', 1)">Low (5)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'human-impact', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'human-impact', 5)">High (1)</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Technical Fit Category -->
                <div class="category-section technical-fit">
                    <div class="category-title">Technical Fit</div>
                    <div class="category-weight">Weight: 40% of total score</div>
                    <div class="risk-factors">
                        <div class="factor-group" data-factor="integration-complexity" data-category="technical">
                            <div class="factor-title">Integration Complexity</div>
                            <div class="factor-subtitle">Legacy-modern system complexity can lead to delays, higher costs, and unstable AI performance across platforms</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'integration-complexity', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'integration-complexity', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'integration-complexity', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="real-time-data" data-category="technical">
                            <div class="factor-title">Real-time Data Requirements</div>
                            <div class="factor-subtitle">LLM agents' latency limits can risk safety and losses in high-speed, time-critical environments</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'real-time-data', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'real-time-data', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'real-time-data', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="autonomy-goal-orientation" data-category="technical">
                            <div class="factor-title">Autonomy & Goal-Orientation</div>
                            <div class="factor-subtitle">From rule-bound execution to guided decisions to fully autonomous, goal-driven multi-step planning</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'autonomy-goal-orientation', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'autonomy-goal-orientation', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'autonomy-goal-orientation', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="statefulness-memory" data-category="technical">
                            <div class="factor-title">Statefulness & Memory</div>
                            <div class="factor-subtitle">Tasks range from stateless to context-aware to requiring memory for long-term reasoning and continuity</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'statefulness-memory', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'statefulness-memory', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'statefulness-memory', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="human-in-loop" data-category="technical">
                            <div class="factor-title">Human-in-the-Loop Requirement</div>
                            <div class="factor-subtitle">Autonomy ranges from full human oversight to partial checkpoints to mostly unattended operation</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'human-in-loop', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'human-in-loop', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'human-in-loop', 5)">High (5)</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Safety and Governance Category -->
                <div class="category-section safety-governance">
                    <div class="category-title">Safety and Governance</div>
                    <div class="category-weight">Weight: 20% of total score</div>
                    <div class="risk-factors">
                        <div class="factor-group" data-factor="governance-requirements" data-category="governance">
                            <div class="factor-title">Governance Requirements</div>
                            <div class="factor-subtitle">Without proper oversight, AI agents can act against policies, laws, or ethics unnoticed until issues arise</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'governance-requirements', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'governance-requirements', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'governance-requirements', 5)">High (5)</button>
                            </div>
                        </div>

                        <div class="factor-group" data-factor="security-implications" data-category="governance">
                            <div class="factor-title">Security Implications</div>
                            <div class="factor-subtitle">Autonomous AI access to sensitive systems creates risks of exploitation and data breaches</div>
                            <div class="risk-buttons">
                                <button type="button" class="risk-btn score-1" onclick="selectRisk(this, 'security-implications', 1)">Low (1)</button>
                                <button type="button" class="risk-btn score-3" onclick="selectRisk(this, 'security-implications', 3)">Medium (3)</button>
                                <button type="button" class="risk-btn score-5" onclick="selectRisk(this, 'security-implications', 5)">High (5)</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="awaitingInput" class="awaiting-input">
                    <h4>Awaiting Input</h4>
                    <p>Complete all required fields and rate all factors to get evaluation.</p>
                </div>

                <div class="section">
                    <h3>AI Evaluation Results</h3>
                    <div id="decisionOutput" class="decision-output">
                        <div class="decision-placeholder">
                            Complete all factor ratings and click Submit to see the AI evaluation results
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="action-buttons">
                        <button id="submitBtn" class="btn btn-primary" onclick="submitAssessment()">Get AI Evaluation</button>
                        <button class="btn btn-secondary" onclick="resetForm()">Reset</button>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="framework-section">
                    <h3>AI-Powered Evaluation</h3>
                    <div class="framework-content">
                        This tool uses Google's Gemini 1.5 Flash to provide intelligent, expert-level assessments for autonomous AI agent implementation. The AI analyzes all factor interactions, use case context, and industry best practices to deliver:
                        <br><br>
                        <strong>Comprehensive Scoring:</strong><br>
                        The AI weighs factors based on your specific use case context rather than simple mathematical averages.
                        <br><br>
                        <strong>Expert Decision Making:</strong><br>
                        • Suitable: Low overall risk, good fit for agentic AI<br>
                        • Cautious: Moderate risk, suitable with safeguards<br>
                        • Not Suitable: High risk, recommend alternatives
                        <br><br>
                        <strong>Intelligent Analysis:</strong><br>
                        The AI considers factor interdependencies and provides tailored recommendations based on your specific scenario.
                    </div>

                    <div class="alternatives">
                        <h4>Alternatives</h4>
                        <ul>
                            <li>Use a rules-based automation system for routine tasks and only involve a human in complex tasks.</li>
                            <li>Use Agentic AI only as a support tool while a human leads the conversation.</li>
                            <li>Start with supervised automation before attempting multi-system autonomy.</li>
                            <li>Create human-led approval workflows for outbound communications and have governance frameworks are in place.</li>
                        </ul>
                    </div>

                    <div class="mitigations">
                        <h4>Mitigations</h4>
                        <ul>
                            <li>Implement cost-governance controls — limit API calls, use budget caps.</li>
                            <li>Set boundaries where Agentic AI escalates to a human for emotionally charged or sensitive topics.</li>
                            <li>For mission-critical systems — store reasoning steps.</li>
                            <li>Implement agent policy enforcement.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // const GEMINI_API_KEY = 'AIzaSyD7zCT8ZAjh_ZdEkO48nzk-T6NDKLNbWcY';
        const GEMINI_API_KEY = 'AIzaSyCVKWx7m-IpEpeViPKgclViRdDxaSrq2LI';
        const GEMINI_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent';

        // Store factor scores
        let factorScores = {};

        // Factor context for AI understanding
        const factorContext = {
            'cost': {
                description: 'Operational costs (LLM API calls), system resource costs (IT infrastructure), and human resource costs',
                risk: 'Agentic AI can create runaway operational costs if decision-making is continuous, high-frequency, or data-intensive',
                alternative: 'Use a rules-based automation system for routine tasks and only involve a human in complex negotiations',
                mitigation: 'Implement cost-governance controls — limit API calls, use budget caps, and introduce checkpoints'
            },
            'time-efficiency': {
                description: 'Cycle time reduction, throughput increase, and latency reduction for customer-facing tasks',
                risk: 'Over-reliance on an autonomous agent for speed can backfire, causing significant delays if the agent cannot handle edge cases',
                alternative: 'Use AI as a decision-support tool that suggests optimal solutions to a human who makes the final call',
                mitigation: 'Design the agent with clear timeout protocols and automatic escalation to a human operator'
            },
            'accuracy-quality': {
                description: 'Error rate reduction, compliance & audit success, and consistency in standardized task execution',
                risk: 'Errors in autonomous decision-making can lead to significant financial loss, compliance violations, and reduction in service quality',
                alternative: 'Use specialized AI for data extraction, but have a human verify accuracy before approval',
                mitigation: 'Implement a tiered-review system where agent handles low-value tasks but flags complex cases for human review'
            },
            'productivity-scalability': {
                description: 'Employee productivity improvements, scalability for larger volumes, and automation coverage percentage',
                risk: 'Focusing solely on scaling tasks can lead to a drop in quality, harming business metrics and requiring human effort to fix damage',
                alternative: 'Use template-based automation for large-scale tasks and reserve AI for analyzing responses',
                mitigation: 'Use the agent to draft and prepare tasks, but require human approval before execution'
            },
            'strategic-opportunity': {
                description: 'Innovation enablement for new business models, competitive advantage, and risk mitigation',
                risk: 'Entrusting high-stakes strategic decisions to an autonomous agent can lead to costly errors based on flawed data',
                alternative: 'Use AI for data gathering and analysis, but have human experts conduct final strategic review',
                mitigation: 'Require the AI to cite sources and provide confidence scores, with mandatory human approval for high-risk actions'
            },
            'transparency': {
                description: 'Need for explainable AI decisions in regulated or customer-facing contexts',
                risk: 'LLM-based decisions can be hard to explain, making it impossible to justify actions to regulators or customers',
                alternative: 'Use structured scoring systems with transparent criteria',
                mitigation: 'Add decision logging and explanation layers — store reasoning steps and generate human-readable justifications'
            },
            'human-impact': {
                description: 'Impact on human roles and customer relationships, empathy requirements',
                risk: 'AI cannot replicate empathy, and removing humans risks harming customer trust and brand reputation',
                alternative: 'Use AI only as a support tool while a human leads the conversation and manages the relationship',
                mitigation: 'Set boundaries where AI escalates to a human for emotionally charged or sensitive topics'
            },
            'integration-complexity': {
                description: 'System integration challenges with legacy and modern systems',
                risk: 'Integration complexity can cause delays, data mismatches, and extra maintenance costs',
                alternative: 'Start with point-specific automation before attempting multi-system autonomy',
                mitigation: 'Adopt modular integration through APIs or middleware that can be swapped without touching all legacy systems'
            },
            'real-time-data': {
                description: 'Real-time processing requirements and latency sensitivity',
                risk: 'LLM decision latency may be unsuitable for millisecond-level or safety-critical operations',
                alternative: 'Use real-time control systems optimized for low latency and deterministic performance',
                mitigation: 'Restrict the AI to offline analysis and process optimization rather than direct, real-time control'
            },
            'autonomy-goal-orientation': {
                description: 'Level of autonomous decision-making needed, from rule-bound to goal-driven planning',
                risk: 'Poorly defined or overly broad goals can lead an agent to take actions that are technically correct but strategically harmful',
                alternative: 'Use rule-based systems for simple tasks and have humans set strategy for complex goals',
                mitigation: 'Define goals with specific guardrail metrics and implement real-time monitoring'
            },
            'statefulness-memory': {
                description: 'Memory and context requirements for long-term reasoning and continuity',
                risk: 'Lack of effective long-term memory can make agents incapable of handling processes requiring previous context',
                alternative: 'Use structured systems where context is explicitly logged by a human at each step',
                mitigation: 'Integrate the agent with a dedicated memory system like a vector database to store and retrieve context'
            },
            'human-in-loop': {
                description: 'Human oversight requirements, from full oversight to minimal checkpoints',
                risk: 'Insufficient human oversight can lead to autonomous actions that violate policies or cause damage',
                alternative: 'Maintain human approval workflows for all external or high-impact actions',
                mitigation: 'Implement checkpoints where humans must approve actions exceeding certain risk thresholds'
            },
            'governance-requirements': {
                description: 'Regulatory and policy compliance needs, oversight requirements',
                risk: 'Without governance, AI agents can violate policies, laws, or ethics, damaging brand and legal standing',
                alternative: 'Create human-led approval workflows until governance frameworks are in place',
                mitigation: 'Implement agent policy enforcement with rules, monitoring dashboards, and human checkpoints'
            },
            'security-implications': {
                description: 'Data security and access control risks from autonomous AI access',
                risk: 'Autonomous agents can be exploited if attackers trick them into unsafe actions',
                alternative: 'Keep critical security processes manual or semi-automated with multi-factor human verification',
                mitigation: 'Enforce strict role-based access control, sandbox the agent, and add anomaly detection'
            }
        };


        async function callGeminiAPI(prompt, retries = 2) {
    for (let i = 0; i <= retries; i++) {
        try {
            const response = await fetch(`${GEMINI_URL}?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.3,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1536,
                    }
                })
            });

            if (!response.ok) {
                if (response.status === 429) {
                    // Rate limit hit - wait longer before retry
                    if (i < retries) {
                        const waitTime = Math.pow(2, i) * 2000; // 2s, 4s, 8s
                        console.log(`Rate limit hit. Waiting ${waitTime/1000}s before retry ${i+1}/${retries}`);
                        await new Promise(resolve => setTimeout(resolve, waitTime));
                        continue;
                    }
                }
                throw new Error(`API Error: ${response.status}`);
            }

            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
            
        } catch (error) {
            if (i === retries) {
                console.error('Gemini API Error:', error);
                throw error;
            }
            // Wait before retry for other errors too
            await new Promise(resolve => setTimeout(resolve, 1000));
        }
    }
}

        // async function callGeminiAPI(prompt) {
        //     try {
        //         const response = await fetch(`${GEMINI_URL}?key=${GEMINI_API_KEY}`, {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/json',
        //             },
        //             body: JSON.stringify({
        //                 contents: [{
        //                     parts: [{
        //                         text: prompt
        //                     }]
        //                 }],
        //                 generationConfig: {
        //                     temperature: 0.3,
        //                     topK: 40,
        //                     topP: 0.95,
        //                     maxOutputTokens: 1536,
        //                 }
        //             })
        //         });

        //         if (!response.ok) {
        //             throw new Error(`API Error: ${response.status}`);
        //         }

        //         const data = await response.json();
        //         return data.candidates[0].content.parts[0].text;
        //     } catch (error) {
        //         console.error('Gemini API Error:', error);
        //         throw error;
        //     }
        // }

        function handleAssessmentMethodChange() {
            const method = document.getElementById('assessmentMethod').value;
            const rolePresetGroup = document.getElementById('rolePresetGroup');
            
            if (method === 'preset') {
                rolePresetGroup.style.display = 'block';
            } else {
                rolePresetGroup.style.display = 'none';
                document.getElementById('rolePreset').value = '';
                document.getElementById('presetLoading').style.display = 'none';
            }
        }

       async function handleRolePresetChange() {
    const rolePreset = document.getElementById('rolePreset').value;
    const useCaseName = document.getElementById('usecaseName').value;
    const description = document.getElementById('description').value;
    
    if (!rolePreset) return;
    
    if (!description.trim()) {
        alert('Please provide a use case description before applying role-specific presets.');
        document.getElementById('rolePreset').value = '';
        return;
    }

    const presetLoading = document.getElementById('presetLoading');
    presetLoading.style.display = 'block';

    try {
        const prompt = createPresetPrompt(rolePreset, useCaseName, description);
        const response = await callGeminiAPI(prompt);
        
        // More robust JSON parsing
        const jsonMatch = response.match(/\{[\s\S]*\}/);
        if (!jsonMatch) {
            console.error('No JSON found in response:', response);
            console.log('Full AI response:', response);
            throw new Error('AI did not return valid JSON format');
        }
        
        let presetScores;
        try {
            presetScores = JSON.parse(jsonMatch[0]);
        } catch (parseError) {
            console.error('JSON parsing failed:', parseError);
            console.log('JSON string that failed:', jsonMatch[0]);
            throw new Error('Invalid JSON format from AI');
        }
        
        // More lenient validation - accept partial responses
        const requiredFactors = [
            'cost', 'time-efficiency', 'accuracy-quality', 'productivity-scalability',
            'strategic-opportunity', 'transparency', 'human-impact',
            'integration-complexity', 'real-time-data', 'autonomy-goal-orientation',
            'statefulness-memory', 'human-in-loop',
            'governance-requirements', 'security-implications'
        ];
        
        const returnedFactors = Object.keys(presetScores);
        const missingFactors = requiredFactors.filter(factor => !presetScores.hasOwnProperty(factor));
        
        console.log('AI returned scores for:', returnedFactors);
        console.log('Missing factors:', missingFactors);
        
        // Accept if we got at least 70% of factors
        if (returnedFactors.length < Math.ceil(requiredFactors.length * 0.7)) {
            console.error('Too few factors returned:', returnedFactors.length, 'out of', requiredFactors.length);
            throw new Error(`AI returned too few factors (${returnedFactors.length}/${requiredFactors.length}). Please try again.`);
        }
        
        // Validate that returned scores are valid (1, 3, or 5)
        const invalidScores = Object.entries(presetScores).filter(([factor, score]) => 
            ![1, 3, 5].includes(score)
        );
        
        if (invalidScores.length > 0) {
            console.error('Invalid scores found:', invalidScores);
            throw new Error('AI returned invalid score values. Please try again.');
        }
        
        // Apply the scores we got
        applyPresetScores(presetScores);
        
        // Inform user about missing factors
        if (missingFactors.length > 0) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
                padding: 15px;
                margin-top: 15px;
                font-size: 13px;
                color: #856404;
            `;
            notification.innerHTML = `
                <strong>Partial preset applied:</strong><br>
                AI provided ratings for ${returnedFactors.length} out of ${requiredFactors.length} factors.<br>
                Please manually rate: ${missingFactors.join(', ')}
            `;
            
            const presetSection = document.querySelector('.preset-section');
            presetSection.appendChild(notification);
            
            // Remove notification after 10 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 10000);
        }
        
    } catch (error) {
        console.error('Full preset error details:', error);
        
        if (error.message.includes('400')) {
            alert('API authentication error. Please check your API key configuration.');
        } else if (error.message.includes('429')) {
            alert('API rate limit reached. Please wait a moment and try again, or select factors manually.');
        } else if (error.message.includes('JSON')) {
            alert('AI response format error. Please try again or select factors manually.');
        } else {
            alert(`Failed to apply role-specific preset: ${error.message}\n\nPlease try again or select factors manually.`);
        }
    } finally {
        presetLoading.style.display = 'none';
    }

            // try {
            //     const prompt = createPresetPrompt(rolePreset, useCaseName, description);
            //     const response = await callGeminiAPI(prompt);
                
            //     // Parse the JSON response
            //     const jsonMatch = response.match(/\{[\s\S]*\}/);
            //     if (!jsonMatch) {
            //         throw new Error('Invalid response format from AI');
            //     }
                
            //     const presetScores = JSON.parse(jsonMatch[0]);
            //     applyPresetScores(presetScores);
                
            // } catch (error) {
            //     console.error('Preset error:', error);
            //     alert('Failed to apply role-specific preset. Please try again or select factors manually.');
            // } finally {
            //     presetLoading.style.display = 'none';
            // }


        }

        function createPresetPrompt(rolePreset, useCaseName, description) {
            const roleContext = {
                'finance': 'Finance teams deal with regulatory compliance, audit requirements, financial data sensitivity, and strict governance. They typically need high transparency, strong governance controls, but may accept higher costs for compliance.',
                'operations': 'Operations teams focus on real-time processes, system reliability, efficiency gains, and minimal downtime. They need fast response times, high automation coverage, but are sensitive to integration complexity.',
                'security': 'Security teams prioritize data protection, access controls, threat mitigation, and risk management. They require strong governance, low security risks, but are cautious about transparency and human oversight.',
                'customer-service': 'Customer service teams value human connection, empathy, customer satisfaction, and brand reputation. They benefit from efficiency gains but are very sensitive to human impact and transparency.'
            };

            const factorContextString = Object.entries(factorContext).map(([factor, context]) => 
                `${factor}: ${context.description} | Risk: ${context.risk}`
            ).join('\n');

            return `
You are an expert AI consultant specializing in role-specific risk assessment for autonomous AI implementation. You understand the detailed context of each factor and their risks.

**Factor Context:**
${factorContextString}

**Role Context:** ${roleContext[rolePreset]}

**Use Case Information:**
- Name: ${useCaseName || 'Custom use case'}
- Description: ${description}
- Selected Role: ${rolePreset}
- Anticipated Autonomy Level: ${autonomyLevel}
- Mission-Critical, Customer-Facing, or Regulatory-Sensitive: ${criticality}

Based on this role's priorities and the specific use case, analyze each factor and provide risk ratings (1=Low, 3=Medium, 5=High) Do not use 2 and 4. Consider:
- The role's typical priorities and constraints
- How the use case aligns with or conflicts with these priorities
- The specific risks each factor poses in this context

Return your response as a JSON object with factor names as keys and risk scores (ONLY 1, 3, or 5) as values:
{
  "cost": 3,
  "time-efficiency": 5,
  "accuracy-quality": 1,
  ...
}

Base your ratings on how each factor's risk level applies to this specific ${rolePreset} use case.
            `.trim();
        }

        function applyPresetScores(presetScores) {
            // Clear existing selections
            document.querySelectorAll('.risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Apply new scores
            factorScores = {};
            for (const [factor, score] of Object.entries(presetScores)) {
                factorScores[factor] = score;
                
                // Find and activate the corresponding button
                const factorGroup = document.querySelector(`[data-factor="${factor}"]`);
                if (factorGroup) {
                    const button = factorGroup.querySelector(`.risk-btn.score-${score}`);
                    if (button) {
                        button.classList.add('active');
                    }
                }
            }
            
            updateAwaitingInput();
        }
function createAssessmentPrompt() {
    const useCaseName = document.getElementById('usecaseName').value || 'Custom use case';
    const description = document.getElementById('description').value;
    const autonomyLevel = document.getElementById('autonomyLevel').value;
    const isCritical = document.getElementById('criticality').value === 'yes';

    // Calculate scores with proper handling of missing values
    const businessFactors = ['cost', 'time-efficiency', 'accuracy-quality', 'productivity-scalability', 'strategic-opportunity', 'transparency', 'human-impact'];
    const technicalFactors = ['integration-complexity', 'real-time-data', 'autonomy-goal-orientation', 'statefulness-memory', 'human-in-loop'];
    const safetyFactors = ['governance-requirements', 'security-implications'];

    const businessSum = businessFactors.reduce((sum, factor) => {
        let score = factorScores[factor];
        if (score === undefined) return sum; // Skip unrated factors
        
        // Reverse score for cost and human-impact (1→5, 3→3, 5→1)
        if (factor === 'cost' || factor === 'human-impact') {
            score = 6 - score;
        }
        return sum + score;
    }, 0);

    const technicalSum = technicalFactors.reduce((sum, factor) => {
        const score = factorScores[factor];
        return score !== undefined ? sum + score : sum;
    }, 0);

    const safetySum = safetyFactors.reduce((sum, factor) => {
        const score = factorScores[factor];
        return score !== undefined ? sum + score : sum;
    }, 0);

    // Calculate averages only for rated factors
    const ratedBusinessFactors = businessFactors.filter(factor => factorScores[factor] !== undefined);
    const ratedTechnicalFactors = technicalFactors.filter(factor => factorScores[factor] !== undefined);
    const ratedSafetyFactors = safetyFactors.filter(factor => factorScores[factor] !== undefined);

    const businessScore = ratedBusinessFactors.length > 0 ? 
        Math.round((businessSum / (ratedBusinessFactors.length * 5)) * 100) : 0;
    const technicalScore = ratedTechnicalFactors.length > 0 ? 
        Math.round((technicalSum / (ratedTechnicalFactors.length * 5)) * 100) : 0;
    const safetyScore = ratedSafetyFactors.length > 0 ? 
        Math.round((safetySum / (ratedSafetyFactors.length * 5)) * 100) : 0;
    
    const totalScore = Math.round((businessScore * 0.4) + (technicalScore * 0.4) + (safetyScore * 0.2));

    // Determine decision based on total score
    let decision, title, subtitle;
    if (totalScore >= 50) {
        decision = 'suitable';
        title = 'Suitable for Autonomous AI';
        subtitle = 'Proceed to pilot, fast track if pilot succeeds';
    } else if (totalScore >= 30) {
        decision = 'cautious';
        title = 'Cautious Approach Recommended';
        subtitle = 'Pilot with constraints and safety measures';
    } else {
        decision = 'not_suitable';
        title = 'Not Suitable for Full Autonomy';
        subtitle = 'Postpone or reframe - start with assisted, not autonomous';
    }

    return `
You are an expert AI consultant. Based on the calculated scores and use case context, provide reasoning for why this decision makes sense.

**Use Case**: ${useCaseName}
**Description**: ${description}
**Anticipated Autonomy Level**: ${autonomyLevel}
**Mission-Critical, Customer-Facing, or Regulatory-Sensitive**: ${criticality}

**Calculated Scores**:
- Business Value: ${businessScore}/100 (based on ${ratedBusinessFactors.length}/${businessFactors.length} factors)
- Technical Fit: ${technicalScore}/100 (based on ${ratedTechnicalFactors.length}/${technicalFactors.length} factors)
- Safety & Governance: ${safetyScore}/100 (based on ${ratedSafetyFactors.length}/${safetyFactors.length} factors)
- Total Score: ${totalScore}/100

**Decision**: ${decision.toUpperCase()}

Provide clear reasoning for why this total score of ${totalScore} leads to a "${decision}" recommendation for this specific use case. Focus on what the scores indicate about the risks and opportunities.

Return JSON format:
{
  "decision": "${decision}",
  "businessScore": ${businessScore},
  "technicalScore": ${technicalScore},
  "safetyScore": ${safetyScore},
  "totalScore": ${totalScore},
  "title": "${title}",
  "subtitle": "${subtitle}",
  "reasoning": "Explain why a score of ${totalScore} justifies the ${decision} decision for this use case",
  "keyRecommendations": ["recommendation 1", "recommendation 2", "recommendation 3"]
}
    `.trim();
}

//         function createAssessmentPrompt() {
//             const useCaseName = document.getElementById('usecaseName').value || 'Custom use case';
//             const description = document.getElementById('description').value;
//             const autonomyLevel = document.getElementById('autonomyLevel').value;
//             const isCritical = document.getElementById('criticality').value === 'yes';

//             // Convert factor scores to readable format with context
//             const businessFactors = {
//                 'cost': factorScores['cost'] || 'Not rated',
//                 'time-efficiency': factorScores['time-efficiency'] || 'Not rated',
//                 'accuracy-quality': factorScores['accuracy-quality'] || 'Not rated',
//                 'productivity-scalability': factorScores['productivity-scalability'] || 'Not rated',
//                 'strategic-opportunity': factorScores['strategic-opportunity'] || 'Not rated',
//                 'transparency': factorScores['transparency'] || 'Not rated',
//                 'human-impact': factorScores['human-impact'] || 'Not rated'
//             };

//             const technicalFactors = {
//                 'integration-complexity': factorScores['integration-complexity'] || 'Not rated',
//                 'real-time-data': factorScores['real-time-data'] || 'Not rated',
//                 'autonomy-goal-orientation': factorScores['autonomy-goal-orientation'] || 'Not rated',
//                 'statefulness-memory': factorScores['statefulness-memory'] || 'Not rated',
//                 'human-in-loop': factorScores['human-in-loop'] || 'Not rated'
//             };

//             const governanceFactors = {
//                 'governance-requirements': factorScores['governance-requirements'] || 'Not rated',
//                 'security-implications': factorScores['security-implications'] || 'Not rated'
//             };

//             // Include factor context for AI understanding
//             const factorContextString = Object.entries(factorContext).map(([factor, context]) => 
//                 `${factor}: ${context.description} | Risk: ${context.risk} | Alternative: ${context.alternative} | Mitigation: ${context.mitigation}`
//             ).join('\n\n');

//             return `
// You are an expert AI consultant specializing in autonomous AI agent implementation. You have deep understanding of each risk factor and must provide comprehensive scoring with clear reasoning for your decision.

// **Factor Context and Detailed Risks:**
// ${factorContextString}

// **Use Case Information:**
// - Name: ${useCaseName}
// - Description: ${description}
// - Anticipated Autonomy Level: ${autonomyLevel}
// - Mission Critical/Customer-Facing/Regulatory-Sensitive: ${isCritical ? 'Yes' : 'No'}

// **Current Factor Ratings:**
// Business Value Factors (40% weight):
// - Cost: ${businessFactors['cost']}
// - Time Efficiency: ${businessFactors['time-efficiency']}
// - Accuracy & Quality: ${businessFactors['accuracy-quality']}
// - Productivity & Scalability: ${businessFactors['productivity-scalability']}
// - Strategic/Opportunity Impact: ${businessFactors['strategic-opportunity']}
// - Transparency: ${businessFactors['transparency']}
// - Human Impact: ${businessFactors['human-impact']}

// Technical Fit Factors (40% weight):
// - Integration Complexity: ${technicalFactors['integration-complexity']}
// - Real-time Data Requirements: ${technicalFactors['real-time-data']}
// - Autonomy & Goal-Orientation: ${technicalFactors['autonomy-goal-orientation']}
// - Statefulness & Memory: ${technicalFactors['statefulness-memory']}
// - Human-in-the-Loop Requirement: ${technicalFactors['human-in-loop']}

// Safety and Governance Factors (20% weight):
// - Governance Requirements: ${governanceFactors['governance-requirements']}
// - Security Implications: ${governanceFactors['security-implications']}

// **Your Expert Analysis Task:**
// 1. Calculate weighted scores for each category (Business: 40%, Technical: 40%, Safety: 20%)
// 2. Determine overall suitability based on factor interactions and use case context
// 3. Provide clear reasoning explaining WHY you made this decision
// 4. Consider the specific risks and mitigations for this use case

// **Decision Framework:**
// - Score ≥ 50: Suitable (proceed to pilot, fast track if pilot succeeds)
// - Score 30-49: Cautious (pilot with constraints and safety measures)
// - Score < 30: Not Suitable (postpone or reframe, start with assisted not autonomous)

// **Important:** Your reasoning must explain:
// - How you weighted the factors for this specific use case
// - Which factors were most critical in your decision
// - Why this decision makes sense given the described use case
// - What specific risks or opportunities influenced your analysis

// Return your response in this exact JSON format:
// {
//   "decision": "suitable" | "cautious" | "not_suitable",
//   "businessScore": 45,
//   "technicalScore": 38,
//   "safetyScore": 42,
//   "totalScore": 41,
//   "title": "Brief decision title",
//   "subtitle": "Short explanation", 
//   "reasoning": "Detailed explanation of your expert analysis. Explain WHY you assigned these scores, which factors were most critical for this use case, how the factors interact, and why this decision makes sense. Be specific about what aspects of the use case influenced your scoring.",
//   "keyRecommendations": ["recommendation 1", "recommendation 2", "recommendation 3"]
// }

// Provide expert-level analysis that clearly explains the reasoning behind your decision and scoring.
//             `.trim();
//         }

        function selectRisk(button, factor, score) {
            // Remove active class from all buttons in this category
            const categoryButtons = button.parentElement.querySelectorAll('.risk-btn');
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            
            // Add active class to clicked button
            button.classList.add('active');
            
            // Store the score
            factorScores[factor] = score;
            
            // Update awaiting input status
            updateAwaitingInput();
        }
        // Calculate scores with reverse scoring for cost and human-impact

        function updateAwaitingInput() {
            const requiredFactors = [
                'cost', 'time-efficiency', 'accuracy-quality', 'productivity-scalability',
                'strategic-opportunity', 'transparency', 'human-impact',
                'integration-complexity', 'real-time-data', 'autonomy-goal-orientation',
                'statefulness-memory', 'human-in-loop',
                'governance-requirements', 'security-implications'
            ];

            const description = document.getElementById('description').value.trim();
            const unratedFactors = requiredFactors.filter(factor => !factorScores.hasOwnProperty(factor));
            const awaitingDiv = document.getElementById('awaitingInput');
            
            if (!description) {
                awaitingDiv.innerHTML = `
                    <h4>Missing Information</h4>
                    <p>Description is required. Please fill in all required fields.</p>
                `;
                awaitingDiv.style.background = '#fff0f0';
                awaitingDiv.style.borderColor = '#ff3b30';
                return;
            }

            if (unratedFactors.length === 0) {
                awaitingDiv.innerHTML = `
                    <h4 style="color: #34c759;">Ready for AI Evaluation</h4>
                    <p>All factors rated. Click "Get AI Evaluation" for expert analysis.</p>
                `;
                awaitingDiv.style.background = '#f0fff0';
                awaitingDiv.style.borderColor = '#34c759';
            } else {
                awaitingDiv.innerHTML = `
                    <h4>Awaiting Input</h4>
                    <p>${unratedFactors.length} factor${unratedFactors.length > 1 ? 's' : ''} remaining to rate.</p>
                `;
                awaitingDiv.style.background = '#f0f8ff';
                awaitingDiv.style.borderColor = '#b3d9ff';
            }
        }

        async function submitAssessment() {
            const description = document.getElementById('description').value.trim();
            const descriptionError = document.getElementById('descriptionError');
            
            // Validate description
            if (!description) {
                descriptionError.style.display = 'block';
                document.getElementById('description').focus();
                return;
            } else {
                descriptionError.style.display = 'none';
            }

            // Check if all factors are rated
            const requiredFactors = [
                'cost', 'time-efficiency', 'accuracy-quality', 'productivity-scalability',
                'strategic-opportunity', 'transparency', 'human-impact',
                'integration-complexity', 'real-time-data', 'autonomy-goal-orientation',
                'statefulness-memory', 'human-in-loop',
                'governance-requirements', 'security-implications'
            ];

            const unratedFactors = requiredFactors.filter(factor => !factorScores.hasOwnProperty(factor));
            if (unratedFactors.length > 0) {
                alert(`Please rate all factors before submitting. ${unratedFactors.length} factor${unratedFactors.length > 1 ? 's' : ''} still need${unratedFactors.length === 1 ? 's' : ''} to be rated.`);
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading"></span>AI is analyzing...';

            try {
                const prompt = createAssessmentPrompt();
                const response = await callGeminiAPI(prompt);
                
                // Parse the JSON response
                const jsonMatch = response.match(/\{[\s\S]*\}/);
                if (!jsonMatch) {
                    throw new Error('Invalid response format from AI');
                }
                
                const assessment = JSON.parse(jsonMatch[0]);
                updateDecisionDisplay(assessment);
                
            } catch (error) {
                console.error('Assessment error:', error);
                const outputDiv = document.getElementById('decisionOutput');
                outputDiv.innerHTML = `
                    <div class="decision-placeholder">
                        <span style="color: #ff3b30;">⚠️ AI Assessment Error</span><br>
                        Failed to get AI assessment. Please check your connection and try again.
                    </div>
                `;
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        function updateDecisionDisplay(assessment) {
            const outputDiv = document.getElementById('decisionOutput');
            
            const decisionConfig = {
                suitable: {
                    icon: '✅',
                    class: 'decision-proceed'
                },
                cautious: {
                    icon: '⚠️',
                    class: 'decision-pilot'
                },
                not_suitable: {
                    icon: '❌',
                    class: 'decision-postpone'
                }
            };

            const config = decisionConfig[assessment.decision] || decisionConfig.cautious;

            const recommendationsHtml = assessment.keyRecommendations && assessment.keyRecommendations.length > 0 ? 
                `<div style="margin-top: 15px; font-size: 12px; text-align: left;">
                    <strong>Key Recommendations:</strong>
                    <ul style="margin: 5px 0 0 20px; list-style: disc;">
                        ${assessment.keyRecommendations.map(rec => `<li style="margin-bottom: 5px;">${rec}</li>`).join('')}
                    </ul>
                 </div>` : '';

            outputDiv.innerHTML = `
                <div class="decision-result">
                    <span class="decision-icon">${config.icon}</span>
                    <div class="decision-title">${assessment.title}</div>
                    <div class="decision-subtitle">${assessment.subtitle}</div>
                    <div class="score-display">
                        <div class="score-breakdown">
                            <div class="score-item">
                                <div class="score-label">Business Value</div>
                                <div class="score-value">${assessment.businessScore}/100</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Technical Fit</div>
                                <div class="score-value">${assessment.technicalScore}/100</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Safety & Governance</div>
                                <div class="score-value">${assessment.safetyScore}/100</div>
                            </div>
                        </div>
                        <div class="total-score">
                            <div class="score-label">Total Score</div>
                            <div class="score-value">${assessment.totalScore}/100</div>
                        </div>
                    </div>
                    <div style="font-size: 13px; line-height: 1.4; text-align: left; margin-top: 15px;">
                        <strong>Expert Analysis:</strong><br>
                        ${assessment.reasoning}
                    </div>
                    ${recommendationsHtml}
                </div>
            `;
            
            outputDiv.className = `decision-output ${config.class}`;
        }

        function resetForm() {
            // Reset form fields
            document.getElementById('usecaseName').value = '';
            document.getElementById('description').value = '';
            document.getElementById('autonomyLevel').value = 'medium';
            document.getElementById('criticality').value = 'yes';
            document.getElementById('assessmentMethod').value = 'manual';
            document.getElementById('rolePreset').value = '';
            
            // Hide role preset group and loading
            document.getElementById('rolePresetGroup').style.display = 'none';
            document.getElementById('presetLoading').style.display = 'none';
            
            // Reset all risk buttons
            document.querySelectorAll('.risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Clear factor scores
            factorScores = {};
            
            // Hide error messages
            document.getElementById('descriptionError').style.display = 'none';
            
            // Reset decision output
            const outputDiv = document.getElementById('decisionOutput');
            outputDiv.innerHTML = '<div class="decision-placeholder">Complete all factor ratings and click Submit to see the AI evaluation results</div>';
            outputDiv.className = 'decision-output';
            
            // Reset awaiting input
            updateAwaitingInput();
        }

        // Add validation for description field
        document.getElementById('description').addEventListener('blur', function() {
            const descriptionError = document.getElementById('descriptionError');
            if (!this.value.trim()) {
                descriptionError.style.display = 'block';
            } else {
                descriptionError.style.display = 'none';
            }
            updateAwaitingInput();
        });

        document.getElementById('description').addEventListener('input', function() {
            updateAwaitingInput();
        });

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            updateAwaitingInput();
        });
    </script>
</body>
</html>
